# Example MetaDefender configuration
# Copy relevant sections to local.d/antivirus.conf and customize

metadefender {
  # Required: Your MetaDefender API key from https://metadefender.opswat.com/
  apikey = "YOUR_API_KEY_HERE";
  
  # Symbol name (default: METADEFENDER_VIRUS)
  symbol = "METADEFENDER_VIRUS";
  
  # Scanner type - must be "metadefender"
  type = "metadefender";
  
  # Scan MIME parts separately instead of full message (recommended: true)
  scan_mime_parts = true;
  
  # Don't scan text or image MIME parts (saves API quota)
  scan_text_mime = false;
  scan_image_mime = false;
  
  # Maximum file size to scan (20MB default)
  max_size = 20000000;
  
  # Log when files are clean (default: false to reduce noise)
  log_clean = false;
  
  # Minimum AV engines that must detect malware before flagging (default: 3)
  # Lower value = more sensitive, may have more false positives
  minimum_engines = 3;
  
  # Number of engines at which maximum score is assigned (default: 7)
  # Scores scale linearly between minimum_engines and full_score_engines
  full_score_engines = 7;
  
  # HTTP request timeout in seconds
  timeout = 5.0;
  
  # Redis cache expiration (2 hours = 7200 seconds)
  # Longer cache reduces API calls but may miss new detections
  cache_expire = 7200;
  
  # Optional: Force an action when malware is detected
  # action = "reject";
  
  # Optional: Custom message template
  # message = '${SCANNER}: virus found: "${VIRUS}"';
}
