# Test configuration for HTML fuzzy hashing

.include(duplicate=append,priority=0) "{= env.TESTDIR =}/configs/plugins.conf"
.include(duplicate=merge,priority=0) "{= env.TESTDIR =}/configs/statistic.conf"

fuzzy_check {
  # Test rule for HTML fuzzy hashing
  rule "TEST_HTML_FUZZY" {
    servers = "localhost:11335";
    algorithm = "mumhash";
    
    # Enable HTML fuzzy hashing
    html_shingles = true;
    min_html_tags = 5;  # Low threshold for testing
    html_weight = 1.0;
    
    symbol = "FUZZY_HTML_TEST";
    max_score = 10.0;
    
    # Skip encryption for testing
    # encryption_key = "";
    
    fuzzy_map = {
      "FUZZY_HTML_WHITELIST" {
        flag = 1;
        max_score = 10.0;
      }
      "FUZZY_HTML_SPAM" {
        flag = 2;
        max_score = 10.0;
      }
    }
  }
  
  # Rule with both text and HTML enabled
  rule "TEST_COMBINED" {
    servers = "localhost:11335";
    algorithm = "mumhash";
    
    html_shingles = true;
    min_html_tags = 3;
    
    symbol = "FUZZY_COMBINED_TEST";
    max_score = 15.0;
    
    fuzzy_map = {
      "FUZZY_COMBINED_MATCH" {
        flag = 10;
        max_score = 15.0;
      }
    }
  }
}
